function brainsprite(c){function a(d){d.mozImageSmoothingEnabled=false;d.webkitImageSmoothingEnabled=false;d.msImageSmoothingEnabled=false;d.imageSmoothingEnabled=false;return d}var b={};b.canvas=document.getElementById(c.canvas);b.canvas=a(b.canvas);b.context=b.canvas.getContext("2d");b.canvasY=document.createElement("canvas");b.canvasY=a(b.canvasY);b.contextY=b.canvasY.getContext("2d");b.canvasZ=document.createElement("canvas");b.canvasZ=a(b.canvasZ);b.contextZ=b.canvasZ.getContext("2d");b.onclick=typeof c.onclick!=="undefined"?c.onclick:"";b.colorBackground=typeof c.colorBackground!=="undefined"?c.colorBackground:"#000000";b.flagCoordinates=typeof c.flagCoordinates!=="undefined"?c.flagCoordinates:false;b.origin=typeof c.origin!=="undefined"?c.origin:{X:0,Y:0,Z:0};b.voxelSize=typeof c.voxelSize!=="undefined"?c.voxelSize:1;b.sizeFont=0.075;b.colorFont=typeof c.colorFont!=="undefined"?c.colorFont:"#FFFFFF";if(b.flagCoordinates){b.spaceFont=0.1}else{b.spaceFont=0}b.sprite=document.getElementById(c.sprite);b.nbCol=b.sprite.width/c.nbSlice.Y;b.nbRow=b.sprite.height/c.nbSlice.Z;b.nbSlice={X:b.nbCol*b.nbRow,Y:c.nbSlice.Y,Z:c.nbSlice.Z};b.widthCanvas={X:0,Y:0,Z:0};b.heightCanvas={X:0,Y:0,Z:0,max:0};b.numSlice={X:Math.floor(b.nbSlice.X/2),Y:Math.floor(b.nbSlice.Y/2),Z:Math.floor(b.nbSlice.Z/2)};b.coordinatesSlice={X:0,Y:0,Z:0};c.overlay=typeof c.overlay!=="undefined"?c.overlay:false;if(c.overlay){b.overlay={};b.overlay.sprite=document.getElementById(c.overlay.sprite);b.overlay.nbCol=b.overlay.sprite.width/c.overlay.nbSlice.Y;b.overlay.nbRow=b.overlay.sprite.height/c.overlay.nbSlice.Z;b.overlay.nbSlice={X:b.overlay.nbCol*b.overlay.nbRow,Y:c.overlay.nbSlice.Y,Z:c.overlay.nbSlice.Z};b.overlay.ratio=b.overlay.nbSlice.Y/b.nbSlice.Y;b.overlay.canvasX=document.createElement("canvas");b.overlay.canvasX=a(b.overlay.canvasX);b.overlay.contextX=b.overlay.canvasX.getContext("2d");b.overlay.canvasY=document.createElement("canvas");b.overlay.canvasY=a(b.overlay.canvasY);b.overlay.contextY=b.overlay.canvasY.getContext("2d");b.overlay.canvasZ=document.createElement("canvas");b.overlay.canvasZ=a(b.overlay.canvasZ);b.overlay.contextZ=b.overlay.canvasZ.getContext("2d");b.overlay.opacity=typeof c.overlay.opacity!=="undefined"?c.overlay.opacity:1}else{b.overlay=false}b.draw=function(i,g){b.numSlice[g]=i;b.widthCanvas.X=Math.floor(b.canvas.parentElement.clientWidth*(b.nbSlice.Y/(2*b.nbSlice.X+b.nbSlice.Y)));b.widthCanvas.Y=Math.floor(b.canvas.parentElement.clientWidth*(b.nbSlice.X/(2*b.nbSlice.X+b.nbSlice.Y)));b.widthCanvas.Z=Math.floor(b.canvas.parentElement.clientWidth*(b.nbSlice.X/(2*b.nbSlice.X+b.nbSlice.Y)));b.heightCanvas.X=Math.floor(b.widthCanvas.X*b.nbSlice.Z/b.nbSlice.Y);b.heightCanvas.Y=Math.floor(b.widthCanvas.Y*b.nbSlice.Z/b.nbSlice.X);b.heightCanvas.Z=Math.floor(b.widthCanvas.Z*b.nbSlice.Y/b.nbSlice.X);b.heightCanvas.max=Math.max(b.heightCanvas.X,b.heightCanvas.Y,b.heightCanvas.Z);if(b.canvas.width!=(b.widthCanvas.X+b.widthCanvas.Y+b.widthCanvas.Z)){b.canvas.width=b.widthCanvas.X+b.widthCanvas.Y+b.widthCanvas.Z;b.canvas.height=Math.round((1+b.spaceFont)*(b.heightCanvas.max))}b.context.fillStyle=b.colorBackground;var h=Math.round(b.sizeFont*(b.heightCanvas.max));b.coordinatesSlice.X=(b.numSlice.X*b.voxelSize)-b.origin.X;b.coordinatesSlice.Y=(b.numSlice.Y*b.voxelSize)-b.origin.Y;b.coordinatesSlice.Z=((b.nbSlice.Z-b.numSlice.Z-1)*b.voxelSize)-b.origin.Z;switch(g){case"X":var d=((b.numSlice.X)%b.nbCol);var f=(b.numSlice.X-d)/b.nbCol;b.context.fillRect(0,0,b.widthCanvas.X,b.canvas.height);b.context.drawImage(b.sprite,d*b.nbSlice.Y,f*b.nbSlice.Z,b.nbSlice.Y,b.nbSlice.Z,0,(b.heightCanvas.max-b.heightCanvas.X)/2,b.widthCanvas.X,b.heightCanvas.X);if(b.overlay){b.overlay.canvasX.width=b.overlay.nbSlice.Y;b.overlay.canvasX.height=b.overlay.nbSlice.Z;b.overlay.contextX.globalAlpha=b.overlay.opacity;var d=((Math.round(b.overlay.ratio*b.numSlice.X))%b.overlay.nbCol);var f=(Math.round(b.overlay.ratio*b.numSlice.X)-d)/b.overlay.nbCol;b.overlay.contextX.drawImage(b.overlay.sprite,d*b.overlay.nbSlice.Y,f*b.overlay.nbSlice.Z,b.overlay.nbSlice.Y,b.overlay.nbSlice.Z,0,0,b.overlay.nbSlice.Y,b.overlay.nbSlice.Z);b.context.drawImage(b.overlay.canvasX,0,0,b.overlay.nbSlice.Y,b.overlay.nbSlice.Z,0,(b.heightCanvas.max-b.heightCanvas.X)/2,b.widthCanvas.X,b.heightCanvas.X)}if(b.flagCoordinates){b.context.font=h+"px Arial";b.context.fillStyle=b.colorFont;var j="x="+b.coordinatesSlice.X;var e=b.context.measureText(j).width;b.context.fillText(j,b.widthCanvas.X/2-e/2,Math.round(b.canvas.height-(h/2)))}break;case"Y":b.context.fillRect(b.widthCanvas.X,0,b.widthCanvas.Y,b.canvas.height);b.canvasY.width=b.nbSlice.X;b.canvasY.height=b.nbSlice.Z;for(xx=0;xx<b.nbSlice.X;xx++){var d=(xx%b.nbCol);var f=(xx-d)/b.nbCol;b.contextY.drawImage(b.sprite,d*b.nbSlice.Y+b.numSlice.Y,f*b.nbSlice.Z,1,b.nbSlice.Z,xx,0,1,b.nbSlice.Z)}b.context.drawImage(b.canvasY,0,0,b.nbSlice.X,b.nbSlice.Z,b.widthCanvas.X,(b.heightCanvas.max-b.heightCanvas.Y)/2,b.widthCanvas.Y,b.heightCanvas.Y);if(b.overlay){b.overlay.canvasY.width=b.overlay.nbSlice.X;b.overlay.canvasY.height=b.overlay.nbSlice.Z;b.overlay.contextY.globalAlpha=b.overlay.opacity;for(xx=0;xx<b.overlay.nbSlice.X;xx++){var d=xx%b.overlay.nbCol;var f=(xx-d)/b.overlay.nbCol;b.overlay.contextY.drawImage(b.overlay.sprite,d*b.overlay.nbSlice.Y+Math.round(b.overlay.ratio*b.numSlice.Y),f*b.overlay.nbSlice.Z,1,b.overlay.nbSlice.Z,xx,0,1,b.overlay.nbSlice.Z)}b.context.drawImage(b.overlay.canvasY,0,0,b.overlay.nbSlice.X,b.overlay.nbSlice.Z,b.widthCanvas.X,(b.heightCanvas.max-b.heightCanvas.Y)/2,b.widthCanvas.Y,b.heightCanvas.Y)}if(b.flagCoordinates){b.context.font=h+"px Arial";b.context.fillStyle=b.colorFont;var j="y="+b.coordinatesSlice.Y;var e=b.context.measureText(j).width;b.context.fillText(j,b.widthCanvas.X+(b.widthCanvas.Y/2)-e/2,Math.round(b.canvas.height-(h/2)))}case"Z":b.context.fillRect(b.widthCanvas.X+b.widthCanvas.Y,0,b.widthCanvas.Z,b.canvas.height);b.canvasZ.width=b.nbSlice.X;b.canvasZ.height=b.nbSlice.Y;b.contextZ.rotate(-Math.PI/2);b.contextZ.translate(-b.nbSlice.Y,0);for(xx=0;xx<b.nbSlice.X;xx++){var d=(xx%b.nbCol);var f=(xx-d)/b.nbCol;b.contextZ.drawImage(b.sprite,d*b.nbSlice.Y,f*b.nbSlice.Z+b.numSlice.Z,b.nbSlice.Y,1,0,xx,b.nbSlice.Y,1)}b.context.drawImage(b.canvasZ,0,0,b.nbSlice.X,b.nbSlice.Y,b.widthCanvas.X+b.widthCanvas.Y,(b.heightCanvas.max-b.heightCanvas.Z)/2,b.widthCanvas.Z,b.heightCanvas.Z);if(b.overlay){b.overlay.canvasZ.width=b.overlay.nbSlice.X;b.overlay.canvasZ.height=b.overlay.nbSlice.Y;b.overlay.contextZ.rotate(-Math.PI/2);b.overlay.contextZ.translate(-b.overlay.nbSlice.Y,0);b.overlay.contextZ.globalAlpha=b.overlay.opacity;for(xx=0;xx<b.overlay.nbSlice.X;xx++){var d=xx%b.overlay.nbCol;var f=(xx-d)/b.overlay.nbCol;b.overlay.contextZ.drawImage(b.overlay.sprite,d*b.overlay.nbSlice.Y,f*b.overlay.nbSlice.Z+Math.round(b.overlay.ratio*b.numSlice.Z),b.overlay.nbSlice.Y,1,0,xx,b.overlay.nbSlice.Y,1)}b.context.drawImage(b.overlay.canvasZ,0,0,b.overlay.nbSlice.X,b.overlay.nbSlice.Y,b.widthCanvas.X+b.widthCanvas.Y,(b.heightCanvas.max-b.heightCanvas.Z)/2,b.widthCanvas.Z,b.heightCanvas.Z)}if(b.flagCoordinates){b.context.font=h+"px Arial";b.context.fillStyle=b.colorFont;var j="z="+b.coordinatesSlice.Z;var e=b.context.measureText(j).width;b.context.fillText(j,b.widthCanvas.X+b.widthCanvas.Y+(b.widthCanvas.Z/2)-e/2,Math.round(b.canvas.height-(h/2)))}}};b.clickBrain=function(f){var h=f.pageX-b.canvas.offsetLeft;var i=f.pageY-b.canvas.offsetTop;if(h<b.widthCanvas.X){var g=Math.round(b.nbSlice.Y*(h/b.widthCanvas.X));var d=Math.round(b.nbSlice.Z*(i-((b.heightCanvas.max-b.heightCanvas.X)/2))/b.heightCanvas.X);b.draw(Math.max(Math.min(g,b.nbSlice.Y-1),0),"Y");b.draw(Math.max(Math.min(d,b.nbSlice.Z-1),0),"Z")}else{if(h<(b.widthCanvas.X+b.widthCanvas.Y)){h=h-b.widthCanvas.X;sx=Math.round(b.nbSlice.X*(h/b.widthCanvas.Y));d=Math.round(b.nbSlice.Z*(i-((b.heightCanvas.max-b.heightCanvas.Y)/2))/b.heightCanvas.Y);b.draw(Math.max(Math.min(sx,b.nbSlice.X-1),0),"X");b.draw(Math.max(Math.min(d,b.nbSlice.Z-1),0),"Z")}else{h=h-b.widthCanvas.X-b.widthCanvas.Y;sx=Math.round(b.nbSlice.X*(h/b.widthCanvas.Z));g=Math.round(b.nbSlice.Y*(1-((i-((b.heightCanvas.max-b.heightCanvas.Z)/2))/b.heightCanvas.Z)));b.draw(Math.max(Math.min(sx,b.nbSlice.X-1),0),"X");b.draw(Math.max(Math.min(g,b.nbSlice.Y-1),0),"Y");b.draw(b.numSlice.Z,"Z")}}};if(b.onclick){b.canvas.addEventListener("click",function(d){b.clickBrain(d);b.onclick(b)},false)}else{b.canvas.addEventListener("click",b.clickBrain,false)}b.canvas.addEventListener("mousedown",function(d){b.canvas.addEventListener("mousemove",b.clickBrain,false)},false);b.canvas.addEventListener("mouseup",function(d){b.canvas.removeEventListener("mousemove",b.clickBrain,false)},false);b.draw(b.numSlice.X,"X");b.draw(b.numSlice.Y,"Y");b.draw(b.numSlice.Z,"Z");return b};