function brainsprite(b){var a={};a.canvas=document.getElementById(b.canvas);a.context=a.canvas.getContext("2d");a.canvasY=document.createElement("canvas");a.contextY=a.canvasY.getContext("2d");a.canvasZ=document.createElement("canvas");a.contextZ=a.canvasZ.getContext("2d");a.onclick=typeof b.onclick!=="undefined"?b.onclick:"";a.colorBackGround=typeof b.colorBackGround!=="undefined"?b.colorBackGround:"#000000";a.flagCoordinates=typeof b.flagCoordinates!=="undefined"?b.flagCoordinates:false;a.origin=typeof b.origin!=="undefined"?b.origin:{X:0,Y:0,Z:0};a.voxelSize=typeof b.voxelSize!=="undefined"?b.voxelSize:1;a.sizeFont=0.075;a.colorFont=typeof b.colorFont!=="undefined"?b.colorFont:"#FFFFFF";if(a.flagCoordinates){a.spaceFont=0.1}else{a.spaceFont=0}a.sprite=document.getElementById(b.sprite);a.nbCol=a.sprite.width/b.nbSlice.Y;a.nbRow=a.sprite.height/b.nbSlice.Z;a.nbSlice={X:a.nbCol*a.nbRow,Y:b.nbSlice.Y,Z:b.nbSlice.Z};a.widthCanvas={X:0,Y:0,Z:0};a.heightCanvas={X:0,Y:0,Z:0,max:0};a.numSlice={X:Math.floor(a.nbSlice.X/2),Y:Math.floor(a.nbSlice.Y/2),Z:Math.floor(a.nbSlice.Z/2)};a.coordinatesSlice={X:0,Y:0,Z:0};b.overlay=typeof b.overlay!=="undefined"?b.overlay:false;if(b.overlay){a.overlay={};a.overlay.sprite=document.getElementById(b.overlay.sprite);a.overlay.nbCol=a.overlay.sprite.width/b.overlay.nbSlice.Y;a.overlay.nbRow=a.overlay.sprite.height/b.overlay.nbSlice.Z;a.overlay.nbSlice={X:a.overlay.nbCol*a.overlay.nbRow,Y:b.overlay.nbSlice.Y,Z:b.overlay.nbSlice.Z};a.overlay.ratio=a.overlay.nbSlice.Y/a.nbSlice.Y;a.overlay.canvasY=document.createElement("canvas");a.overlay.contextY=a.overlay.canvasY.getContext("2d");a.overlay.canvasZ=document.createElement("canvas");a.overlay.contextZ=a.overlay.canvasZ.getContext("2d")}else{a.overlay=false}a.draw=function(h,f){a.numSlice[f]=h;a.widthCanvas.X=Math.floor(a.canvas.parentElement.clientWidth*(a.nbSlice.Y/(2*a.nbSlice.X+a.nbSlice.Y)));a.widthCanvas.Y=Math.floor(a.canvas.parentElement.clientWidth*(a.nbSlice.X/(2*a.nbSlice.X+a.nbSlice.Y)));a.widthCanvas.Z=Math.floor(a.canvas.parentElement.clientWidth*(a.nbSlice.X/(2*a.nbSlice.X+a.nbSlice.Y)));a.heightCanvas.X=Math.floor(a.widthCanvas.X*a.nbSlice.Z/a.nbSlice.Y);a.heightCanvas.Y=Math.floor(a.widthCanvas.Y*a.nbSlice.Z/a.nbSlice.X);a.heightCanvas.Z=Math.floor(a.widthCanvas.Z*a.nbSlice.Y/a.nbSlice.X);a.heightCanvas.max=Math.max(a.heightCanvas.X,a.heightCanvas.Y,a.heightCanvas.Z);if(a.canvas.width!=(a.widthCanvas.X+a.widthCanvas.Y+a.widthCanvas.Z)){a.canvas.width=a.widthCanvas.X+a.widthCanvas.Y+a.widthCanvas.Z;a.canvas.height=Math.round((1+a.spaceFont)*(a.heightCanvas.max))}a.context.fillStyle=a.colorBackGround;var g=Math.round(a.sizeFont*(a.heightCanvas.max));a.coordinatesSlice.X=(a.numSlice.X*a.voxelSize)-a.origin.X;a.coordinatesSlice.Y=(a.numSlice.Y*a.voxelSize)-a.origin.Y;a.coordinatesSlice.Z=((a.nbSlice.Z-a.numSlice.Z-1)*a.voxelSize)-a.origin.Z;switch(f){case"X":var c=((a.numSlice.X)%a.nbCol);var e=(a.numSlice.X-c)/a.nbCol;a.context.fillRect(0,0,a.widthCanvas.X,a.canvas.height);a.context.drawImage(a.sprite,c*a.nbSlice.Y,e*a.nbSlice.Z,a.nbSlice.Y,a.nbSlice.Z,0,(a.heightCanvas.max-a.heightCanvas.X)/2,a.widthCanvas.X,a.heightCanvas.X);if(a.overlay){var c=((Math.round(a.overlay.ratio*a.numSlice.X))%a.overlay.nbCol);var e=(Math.round(a.overlay.ratio*a.numSlice.X)-c)/a.overlay.nbCol;a.context.drawImage(a.overlay.sprite,c*a.overlay.nbSlice.Y,e*a.overlay.nbSlice.Z,a.overlay.nbSlice.Y,a.overlay.nbSlice.Z,0,(a.heightCanvas.max-a.heightCanvas.X)/2,a.widthCanvas.X,a.heightCanvas.X)}if(a.flagCoordinates){a.context.font=g+"px Arial";a.context.fillStyle=a.colorFont;var i="x="+a.coordinatesSlice.X;var d=a.context.measureText(i).width;a.context.fillText(i,a.widthCanvas.X/2-d/2,Math.round(a.canvas.height-(g/2)))}break;case"Y":a.context.fillRect(a.widthCanvas.X,0,a.widthCanvas.Y,a.canvas.height);a.canvasY.width=a.nbSlice.X;a.canvasY.height=a.nbSlice.Z;for(xx=0;xx<a.nbSlice.X;xx++){var c=(xx%a.nbCol);var e=(xx-c)/a.nbCol;a.contextY.drawImage(a.sprite,c*a.nbSlice.Y+a.numSlice.Y,e*a.nbSlice.Z,1,a.nbSlice.Z,xx,0,1,a.nbSlice.Z)}a.context.drawImage(a.canvasY,0,0,a.nbSlice.X,a.nbSlice.Z,a.widthCanvas.X,(a.heightCanvas.max-a.heightCanvas.Y)/2,a.widthCanvas.Y,a.heightCanvas.Y);if(a.overlay){a.overlay.canvasY.width=a.overlay.nbSlice.X;a.overlay.canvasY.height=a.overlay.nbSlice.Z;for(xx=0;xx<a.overlay.nbSlice.X;xx++){var c=xx%a.overlay.nbCol;var e=(xx-c)/a.overlay.nbCol;a.overlay.contextY.drawImage(a.overlay.sprite,c*a.overlay.nbSlice.Y+Math.round(a.overlay.ratio*a.numSlice.Y),e*a.overlay.nbSlice.Z,1,a.overlay.nbSlice.Z,xx,0,1,a.overlay.nbSlice.Z)}a.context.drawImage(a.overlay.canvasY,0,0,a.overlay.nbSlice.X,a.overlay.nbSlice.Z,a.widthCanvas.X,(a.heightCanvas.max-a.heightCanvas.Y)/2,a.widthCanvas.Y,a.heightCanvas.Y)}if(a.flagCoordinates){a.context.font=g+"px Arial";a.context.fillStyle=a.colorFont;var i="y="+a.coordinatesSlice.Y;var d=a.context.measureText(i).width;a.context.fillText(i,a.widthCanvas.X+(a.widthCanvas.Y/2)-d/2,Math.round(a.canvas.height-(g/2)))}case"Z":a.context.fillRect(a.widthCanvas.X+a.widthCanvas.Y,0,a.widthCanvas.Z,a.canvas.height);a.canvasZ.width=a.nbSlice.X;a.canvasZ.height=a.nbSlice.Y;a.contextZ.rotate(-Math.PI/2);a.contextZ.translate(-a.nbSlice.Y,0);for(xx=0;xx<a.nbSlice.X;xx++){var c=(xx%a.nbCol);var e=(xx-c)/a.nbCol;a.contextZ.drawImage(a.sprite,c*a.nbSlice.Y,e*a.nbSlice.Z+a.numSlice.Z,a.nbSlice.Y,1,0,xx,a.nbSlice.Y,1)}a.context.drawImage(a.canvasZ,0,0,a.nbSlice.X,a.nbSlice.Y,a.widthCanvas.X+a.widthCanvas.Y,(a.heightCanvas.max-a.heightCanvas.Z)/2,a.widthCanvas.Z,a.heightCanvas.Z);if(a.overlay){a.overlay.canvasZ.width=a.overlay.nbSlice.X;a.overlay.canvasZ.height=a.overlay.nbSlice.Y;a.overlay.contextZ.rotate(-Math.PI/2);a.overlay.contextZ.translate(-a.overlay.nbSlice.Y,0);for(xx=0;xx<a.overlay.nbSlice.X;xx++){var c=xx%a.overlay.nbCol;var e=(xx-c)/a.overlay.nbCol;a.overlay.contextZ.drawImage(a.overlay.sprite,c*a.overlay.nbSlice.Y,e*a.overlay.nbSlice.Z+Math.round(a.overlay.ratio*a.numSlice.Z),a.overlay.nbSlice.Y,1,0,xx,a.overlay.nbSlice.Y,1)}a.context.drawImage(a.overlay.canvasZ,0,0,a.overlay.nbSlice.X,a.overlay.nbSlice.Y,a.widthCanvas.X+a.widthCanvas.Y,(a.heightCanvas.max-a.heightCanvas.Z)/2,a.widthCanvas.Z,a.heightCanvas.Z)}if(a.flagCoordinates){a.context.font=g+"px Arial";a.context.fillStyle=a.colorFont;var i="z="+a.coordinatesSlice.Z;var d=a.context.measureText(i).width;a.context.fillText(i,a.widthCanvas.X+a.widthCanvas.Y+(a.widthCanvas.Z/2)-d/2,Math.round(a.canvas.height-(g/2)))}}};a.clickBrain=function(d){var g=d.pageX-a.canvas.offsetLeft;var h=d.pageY-a.canvas.offsetTop;if(g<a.widthCanvas.X){var f=Math.round(a.nbSlice.Y*(g/a.widthCanvas.X));var c=Math.round(a.nbSlice.Z*(h-((a.heightCanvas.max-a.heightCanvas.X)/2))/a.heightCanvas.X);a.draw(Math.max(Math.min(f,a.nbSlice.Y-1),0),"Y");a.draw(Math.max(Math.min(c,a.nbSlice.Z-1),0),"Z")}else{if(g<(a.widthCanvas.X+a.widthCanvas.Y)){g=g-a.widthCanvas.X;sx=Math.round(a.nbSlice.X*(g/a.widthCanvas.Y));c=Math.round(a.nbSlice.Z*(h-((a.heightCanvas.max-a.heightCanvas.Y)/2))/a.heightCanvas.Y);a.draw(Math.max(Math.min(sx,a.nbSlice.X-1),0),"X");a.draw(Math.max(Math.min(c,a.nbSlice.Z-1),0),"Z")}else{g=g-a.widthCanvas.X-a.widthCanvas.Y;sx=Math.round(a.nbSlice.X*(g/a.widthCanvas.Z));f=Math.round(a.nbSlice.Y*(1-((h-((a.heightCanvas.max-a.heightCanvas.Z)/2))/a.heightCanvas.Z)));a.draw(Math.max(Math.min(sx,a.nbSlice.X-1),0),"X");a.draw(Math.max(Math.min(f,a.nbSlice.Y-1),0),"Y");a.draw(a.numSlice.Z,"Z")}}};if(a.onclick){a.canvas.addEventListener("click",function(c){a.clickBrain(c);a.onclick(a)},false)}else{a.canvas.addEventListener("click",function(c){a.clickBrain(c)},false)}a.draw(a.numSlice.X,"X");a.draw(a.numSlice.Y,"Y");a.draw(a.numSlice.Z,"Z");return a};